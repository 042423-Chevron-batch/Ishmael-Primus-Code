{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _writableTrackingBuffer = _interopRequireDefault(require(\"./tracking-buffer/writable-tracking-buffer\"));\nvar _allHeaders = require(\"./all-headers\");\nlet _Symbol$iterator;\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\n// const OPTION = {\n//   WITH_RECOMPILE: 0x01,\n//   NO_METADATA: 0x02,\n//   REUSE_METADATA: 0x04\n// };\nconst STATUS = {\n  BY_REF_VALUE: 0x01,\n  DEFAULT_VALUE: 0x02\n};\n/*\n  s2.2.6.5\n */\n\n_Symbol$iterator = Symbol.iterator;\nclass RpcRequestPayload {\n  constructor(procedure, parameters, txnDescriptor, options, collation) {\n    this.procedure = void 0;\n    this.parameters = void 0;\n    this.options = void 0;\n    this.txnDescriptor = void 0;\n    this.collation = void 0;\n    this.procedure = procedure;\n    this.parameters = parameters;\n    this.options = options;\n    this.txnDescriptor = txnDescriptor;\n    this.collation = collation;\n  }\n  [_Symbol$iterator]() {\n    return this.generateData();\n  }\n  *generateData() {\n    const buffer = new _writableTrackingBuffer.default(500);\n    if (this.options.tdsVersion >= '7_2') {\n      const outstandingRequestCount = 1;\n      (0, _allHeaders.writeToTrackingBuffer)(buffer, this.txnDescriptor, outstandingRequestCount);\n    }\n    if (typeof this.procedure === 'string') {\n      buffer.writeUsVarchar(this.procedure);\n    } else {\n      buffer.writeUShort(0xFFFF);\n      buffer.writeUShort(this.procedure);\n    }\n    const optionFlags = 0;\n    buffer.writeUInt16LE(optionFlags);\n    yield buffer.data;\n    const parametersLength = this.parameters.length;\n    for (let i = 0; i < parametersLength; i++) {\n      yield* this.generateParameterData(this.parameters[i]);\n    }\n  }\n  toString(indent = '') {\n    return indent + ('RPC Request - ' + this.procedure);\n  }\n  *generateParameterData(parameter) {\n    const buffer = new _writableTrackingBuffer.default(1 + 2 + Buffer.byteLength(parameter.name, 'ucs-2') + 1);\n    buffer.writeBVarchar('@' + parameter.name);\n    let statusFlags = 0;\n    if (parameter.output) {\n      statusFlags |= STATUS.BY_REF_VALUE;\n    }\n    buffer.writeUInt8(statusFlags);\n    yield buffer.data;\n    const param = {\n      value: parameter.value\n    };\n    const type = parameter.type;\n    if ((type.id & 0x30) === 0x20) {\n      if (parameter.length) {\n        param.length = parameter.length;\n      } else if (type.resolveLength) {\n        param.length = type.resolveLength(parameter);\n      }\n    }\n    if (parameter.precision) {\n      param.precision = parameter.precision;\n    } else if (type.resolvePrecision) {\n      param.precision = type.resolvePrecision(parameter);\n    }\n    if (parameter.scale) {\n      param.scale = parameter.scale;\n    } else if (type.resolveScale) {\n      param.scale = type.resolveScale(parameter);\n    }\n    if (this.collation) {\n      param.collation = this.collation;\n    }\n    yield type.generateTypeInfo(param, this.options);\n    yield type.generateParameterLength(param, this.options);\n    yield* type.generateParameterData(param, this.options);\n  }\n}\nvar _default = RpcRequestPayload;\nexports.default = _default;\nmodule.exports = RpcRequestPayload;","map":{"version":3,"names":["Object","defineProperty","exports","value","default","_writableTrackingBuffer","_interopRequireDefault","require","_allHeaders","_Symbol$iterator","obj","__esModule","STATUS","BY_REF_VALUE","DEFAULT_VALUE","Symbol","iterator","RpcRequestPayload","constructor","procedure","parameters","txnDescriptor","options","collation","generateData","buffer","tdsVersion","outstandingRequestCount","writeToTrackingBuffer","writeUsVarchar","writeUShort","optionFlags","writeUInt16LE","data","parametersLength","length","i","generateParameterData","toString","indent","parameter","Buffer","byteLength","name","writeBVarchar","statusFlags","output","writeUInt8","param","type","id","resolveLength","precision","resolvePrecision","scale","resolveScale","generateTypeInfo","generateParameterLength","_default","module"],"sources":["C:/Users/ishma/Revature/Ishmael-Primus-Code-/ecomm-prj1/node_modules/tedious/lib/rpcrequest-payload.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _writableTrackingBuffer = _interopRequireDefault(require(\"./tracking-buffer/writable-tracking-buffer\"));\n\nvar _allHeaders = require(\"./all-headers\");\n\nlet _Symbol$iterator;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// const OPTION = {\n//   WITH_RECOMPILE: 0x01,\n//   NO_METADATA: 0x02,\n//   REUSE_METADATA: 0x04\n// };\nconst STATUS = {\n  BY_REF_VALUE: 0x01,\n  DEFAULT_VALUE: 0x02\n};\n/*\n  s2.2.6.5\n */\n\n_Symbol$iterator = Symbol.iterator;\n\nclass RpcRequestPayload {\n  constructor(procedure, parameters, txnDescriptor, options, collation) {\n    this.procedure = void 0;\n    this.parameters = void 0;\n    this.options = void 0;\n    this.txnDescriptor = void 0;\n    this.collation = void 0;\n    this.procedure = procedure;\n    this.parameters = parameters;\n    this.options = options;\n    this.txnDescriptor = txnDescriptor;\n    this.collation = collation;\n  }\n\n  [_Symbol$iterator]() {\n    return this.generateData();\n  }\n\n  *generateData() {\n    const buffer = new _writableTrackingBuffer.default(500);\n\n    if (this.options.tdsVersion >= '7_2') {\n      const outstandingRequestCount = 1;\n      (0, _allHeaders.writeToTrackingBuffer)(buffer, this.txnDescriptor, outstandingRequestCount);\n    }\n\n    if (typeof this.procedure === 'string') {\n      buffer.writeUsVarchar(this.procedure);\n    } else {\n      buffer.writeUShort(0xFFFF);\n      buffer.writeUShort(this.procedure);\n    }\n\n    const optionFlags = 0;\n    buffer.writeUInt16LE(optionFlags);\n    yield buffer.data;\n    const parametersLength = this.parameters.length;\n\n    for (let i = 0; i < parametersLength; i++) {\n      yield* this.generateParameterData(this.parameters[i]);\n    }\n  }\n\n  toString(indent = '') {\n    return indent + ('RPC Request - ' + this.procedure);\n  }\n\n  *generateParameterData(parameter) {\n    const buffer = new _writableTrackingBuffer.default(1 + 2 + Buffer.byteLength(parameter.name, 'ucs-2') + 1);\n    buffer.writeBVarchar('@' + parameter.name);\n    let statusFlags = 0;\n\n    if (parameter.output) {\n      statusFlags |= STATUS.BY_REF_VALUE;\n    }\n\n    buffer.writeUInt8(statusFlags);\n    yield buffer.data;\n    const param = {\n      value: parameter.value\n    };\n    const type = parameter.type;\n\n    if ((type.id & 0x30) === 0x20) {\n      if (parameter.length) {\n        param.length = parameter.length;\n      } else if (type.resolveLength) {\n        param.length = type.resolveLength(parameter);\n      }\n    }\n\n    if (parameter.precision) {\n      param.precision = parameter.precision;\n    } else if (type.resolvePrecision) {\n      param.precision = type.resolvePrecision(parameter);\n    }\n\n    if (parameter.scale) {\n      param.scale = parameter.scale;\n    } else if (type.resolveScale) {\n      param.scale = type.resolveScale(parameter);\n    }\n\n    if (this.collation) {\n      param.collation = this.collation;\n    }\n\n    yield type.generateTypeInfo(param, this.options);\n    yield type.generateParameterLength(param, this.options);\n    yield* type.generateParameterData(param, this.options);\n  }\n\n}\n\nvar _default = RpcRequestPayload;\nexports.default = _default;\nmodule.exports = RpcRequestPayload;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}