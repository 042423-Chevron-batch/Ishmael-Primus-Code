{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _bl = _interopRequireDefault(require(\"bl\"));\nvar _stream = require(\"stream\");\nvar _packet = require(\"./packet\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nclass OutgoingMessageStream extends _stream.Duplex {\n  constructor(debug, {\n    packetSize\n  }) {\n    super({\n      writableObjectMode: true\n    });\n    this.packetSize = void 0;\n    this.debug = void 0;\n    this.bl = void 0;\n    this.currentMessage = void 0;\n    this.packetSize = packetSize;\n    this.debug = debug;\n    this.bl = new _bl.default(); // When the writable side is ended, push `null`\n    // to also end the readable side.\n\n    this.on('finish', () => {\n      this.push(null);\n    });\n  }\n  _write(message, _encoding, callback) {\n    const length = this.packetSize - _packet.HEADER_LENGTH;\n    let packetNumber = 0;\n    this.currentMessage = message;\n    this.currentMessage.on('data', data => {\n      if (message.ignore) {\n        return;\n      }\n      this.bl.append(data);\n      while (this.bl.length > length) {\n        const data = this.bl.slice(0, length);\n        this.bl.consume(length); // TODO: Get rid of creating `Packet` instances here.\n\n        const packet = new _packet.Packet(message.type);\n        packet.packetId(packetNumber += 1);\n        packet.resetConnection(message.resetConnection);\n        packet.addData(data);\n        this.debug.packet('Sent', packet);\n        this.debug.data(packet);\n        if (this.push(packet.buffer) === false) {\n          message.pause();\n        }\n      }\n    });\n    this.currentMessage.on('end', () => {\n      const data = this.bl.slice();\n      this.bl.consume(data.length); // TODO: Get rid of creating `Packet` instances here.\n\n      const packet = new _packet.Packet(message.type);\n      packet.packetId(packetNumber += 1);\n      packet.resetConnection(message.resetConnection);\n      packet.last(true);\n      packet.ignore(message.ignore);\n      packet.addData(data);\n      this.debug.packet('Sent', packet);\n      this.debug.data(packet);\n      this.push(packet.buffer);\n      this.currentMessage = undefined;\n      callback();\n    });\n  }\n  _read(_size) {\n    // If we do have a message, resume it and get data flowing.\n    // Otherwise, there is nothing to do.\n    if (this.currentMessage) {\n      this.currentMessage.resume();\n    }\n  }\n}\nvar _default = OutgoingMessageStream;\nexports.default = _default;\nmodule.exports = OutgoingMessageStream;","map":{"version":3,"names":["Object","defineProperty","exports","value","default","_bl","_interopRequireDefault","require","_stream","_packet","obj","__esModule","OutgoingMessageStream","Duplex","constructor","debug","packetSize","writableObjectMode","bl","currentMessage","on","push","_write","message","_encoding","callback","length","HEADER_LENGTH","packetNumber","data","ignore","append","slice","consume","packet","Packet","type","packetId","resetConnection","addData","buffer","pause","last","undefined","_read","_size","resume","_default","module"],"sources":["C:/Users/ishma/Revature/Ishmael-Primus-Code-/ecomm-prj1/node_modules/tedious/lib/outgoing-message-stream.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _bl = _interopRequireDefault(require(\"bl\"));\n\nvar _stream = require(\"stream\");\n\nvar _packet = require(\"./packet\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nclass OutgoingMessageStream extends _stream.Duplex {\n  constructor(debug, {\n    packetSize\n  }) {\n    super({\n      writableObjectMode: true\n    });\n    this.packetSize = void 0;\n    this.debug = void 0;\n    this.bl = void 0;\n    this.currentMessage = void 0;\n    this.packetSize = packetSize;\n    this.debug = debug;\n    this.bl = new _bl.default(); // When the writable side is ended, push `null`\n    // to also end the readable side.\n\n    this.on('finish', () => {\n      this.push(null);\n    });\n  }\n\n  _write(message, _encoding, callback) {\n    const length = this.packetSize - _packet.HEADER_LENGTH;\n    let packetNumber = 0;\n    this.currentMessage = message;\n    this.currentMessage.on('data', data => {\n      if (message.ignore) {\n        return;\n      }\n\n      this.bl.append(data);\n\n      while (this.bl.length > length) {\n        const data = this.bl.slice(0, length);\n        this.bl.consume(length); // TODO: Get rid of creating `Packet` instances here.\n\n        const packet = new _packet.Packet(message.type);\n        packet.packetId(packetNumber += 1);\n        packet.resetConnection(message.resetConnection);\n        packet.addData(data);\n        this.debug.packet('Sent', packet);\n        this.debug.data(packet);\n\n        if (this.push(packet.buffer) === false) {\n          message.pause();\n        }\n      }\n    });\n    this.currentMessage.on('end', () => {\n      const data = this.bl.slice();\n      this.bl.consume(data.length); // TODO: Get rid of creating `Packet` instances here.\n\n      const packet = new _packet.Packet(message.type);\n      packet.packetId(packetNumber += 1);\n      packet.resetConnection(message.resetConnection);\n      packet.last(true);\n      packet.ignore(message.ignore);\n      packet.addData(data);\n      this.debug.packet('Sent', packet);\n      this.debug.data(packet);\n      this.push(packet.buffer);\n      this.currentMessage = undefined;\n      callback();\n    });\n  }\n\n  _read(_size) {\n    // If we do have a message, resume it and get data flowing.\n    // Otherwise, there is nothing to do.\n    if (this.currentMessage) {\n      this.currentMessage.resume();\n    }\n  }\n\n}\n\nvar _default = OutgoingMessageStream;\nexports.default = _default;\nmodule.exports = OutgoingMessageStream;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}